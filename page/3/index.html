<!DOCTYPE html>
<html lang="zh-cn">
  <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">

  <meta name="generator" content="Hugo 0.111.3">
  <link rel="canonical" href="http://keenmisty.github.io/">

  
    
      <meta name="description" content="A Hugo theme made with PaperCSS, the less formal CSS framework.">
    
  

  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">
  <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#000000">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="theme-color" content="#ffffff">

  <link rel="stylesheet" type="text/css" href="/css/paper.css">

  
  
  <link rel="stylesheet" type="text/css" href="/css/custom.css">
  
  
    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-123456789-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
  

  
  
    
  
  <title>南村新造</title>
</head>

  <body>
    <div class="container paper">
      <nav class="border split-nav">
  <div class="nav-brand">
    <h3><a href="/">南村新造</a></h3>
  </div>
  <div class="collapsible">
    <input id="collapsible1" type="checkbox" name="collapsible1">
    <button>
    <label for="collapsible1">
        <div class="bar1"></div>
        <div class="bar2"></div>
        <div class="bar3"></div>
      </label>
    </button>
    <div class="collapsible-body">
      <ul class="inline">
      
        <li><a href="/">Blog</a></li>
      
        <li><a href="/tags/">Tags</a></li>
      
        <li><a href="/about/">About</a></li>
      
        <li><a href="/index.xml">RSS</a></li>
      
      </ul>
    </div>
  </div>
</nav>
      <main>
        

<h1>南村新造</h1>




  <h2 class="post-list summary">
    <a href="/20180706pythondocx-md/">
      基于python-docx生成半自动化的word报告
    </a>
  </h2>
  
    缘起： 一直以来都有个需求是将固定格式的文档自动化生成，我以前曾经拿latex尝试过，效果其实很好，在linux下直接就可以生成pdf文档，非常适宜于放在服务器上。 然而，可悲的现实在于，latex过于阳春白雪。要说服更多的人走出自己的舒服区掌握一项新技能，实在是一件比触动灵魂更难的事情。 好在word还算是很多人都会的一个软件，而python也受到越来越多的人的青睐，我也希望走出自己的舒服区来尽量多的尝试它、学会它。
快速入门： 讲真，最快的入门方式就是看它的官方文档，即：https://python-docx.readthedocs.io/en/latest/ 不过我想，还是有一些值得记录下来的点作为笔记留作后用：
安装 python-docx的安装很简单，pip install即可。如果有anaconda的话，可以conda安装。
避免版本问题 由于python有2和3的问题，所以调用module时需要针对性的进行一些修改。
# for python 2.7 reload(sys) sys.setdefaultencoding(&#39;utf-8&#39;) # for python &lt;=3.3 import imp imp.reload(sys) # for python &gt;=3.4 import importlib importlib.reload(sys) 设置字体 python-docx使用styles.font来指定字体的设置。方式如下： document.styles[&#39;Normal&#39;].font.name = u&#39;仿宋&#39; document.styles[&#39;Normal&#39;]._element.rPr.rFonts.set(qn(&#39;w:eastAsia&#39;), u&#39;仿宋&#39;) 添加分页符 document.add_page_break() 表格
与其他数据的衔接
后期调整
待续。。。
  

  <h2 class="post-list summary">
    <a href="/20180402-glc/">
      GLC2015土地覆被的邪门问题
    </a>
  </h2>
  
    之前更新了GLC2015的土地覆被资料到EMEP模型的输入，但是测试来测试去居然跟default的土地覆被资料模拟所得到的结果完全一致。 奇哉怪哉，难道说EMEP模型模拟时landuse不起作用吗？ 这个疑问看来要花点精力去解决了。 今日又遇到了另一个邪门问题，GLC2015的资料按USGS的24类体系重新分类之后，居然在东北华北出现了大面积的水体。 检查来检查去发现，GLC2015把自身的第11类设为了Herbaceous Cover，这尼玛什么鬼。。。 待续。。。
  

  <h2 class="post-list summary">
    <a href="/20180328-update-npm/">
      郁闷的升级
    </a>
  </h2>
  
    好久没有更新博客了，天天忙各种杂事。
抽出晚饭的一点时间，本来是想升级一下hexo的版本，结果发现自己的node版本太旧无法支持升级，于是又升级node。搜索了一下以为很容易，没想到windows下又各种坑，不停的失败。 还好-force选项解救了我。。。然后顺利的更新了依赖链上的每个环节。
-force，如果也可以不停的-force其他人就好了，可惜总是我才是被-force的那个。。。
  

  <h2 class="post-list summary">
    <a href="/20170807-change/">
      新的主题，新的开始
    </a>
  </h2>
  
    趁着暑假，忙里偷闲，把主题换成了Meterial，感觉清爽了很多。 同时从下个学期，正式获得了教师的身份，抛开过去，新的开始。
希望过去不再不堪回首，现在不再不堪忍受，未来不再不堪想象&hellip;
  

  <h2 class="post-list summary">
    <a href="/20161031-doxygen/">
      用Doxygen&#43;Graphviz生成WRF-Chem程序结构图
    </a>
  </h2>
  
    缘起 做毕业论文的时候要改机制代码，并且要耦合到WRF-Chem模式里面使它生效，所以就需要搞清楚WRF-Chem的结构，以便调用和输出。
虽然可以通过长时间的看WRF-Chem源代码、debug尝试以及IDE帮忙，但有一份calling tree还是很好的，给师弟师妹们讲起来也方便很多。
因此，考虑尝试用程序结构自动分析工具Doxygen对它进行分析，用Graphviz生成出来。
Doxygen简介 Doxygen是一种程序结构自动分析的工具，也是一个程序文档自动生成的工具，它的官网，具体的使用方法可以在上面找到。
由于Doxygen支持Fortran，因此，直接拿来分析WRF-Chem就很简单了，配置好输出的目录及分析的项目，设置好调用Graphviz的路径，就可以直接运行输出了。
它可以生成html版的网页说明，也可以生成LaTeX文件及pdf文档。
WRF-Chem Calling Tree 物理机制-微物理过程调用： 物理机制-辐射过程调用： 物理机制-积云过程调用： 物理机制-陆面及边界层过程调用： 化学机制-化学过程调用： 后记 其实真的要改机制时还是要进去一点一点的看code的，这些图也就帮助下新手理解&hellip; (说白了其实没啥用，然而做无用之事不是我辈博士生打发生命的最佳方式吗2333)
  


<div class="row flex-center margin-top-large">
 
  <a href="/" class="paper-btn">&laquo;&laquo;</a>
  <a href="/page/2/" class="paper-btn">&laquo;</a>

    <a class="paper-btn" href="/">1</a>

    <a class="paper-btn" href="/page/2/">2</a>

    <a class="paper-btn active" href="/page/3/">3</a>

    <a class="paper-btn" href="/page/4/">4</a>

    <a class="paper-btn" href="/page/5/">5</a>

    <a href="/page/4/" class="paper-btn ">&raquo;</a>

    <a href="/page/5/" class="paper-btn">&raquo;&raquo;</a>
  </div>




      </main>
  </div>
  </body>
</html>
